<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="2024 Code overview" href="../2024CodeOverview/index.html" /><link rel="prev" title="Color-based segmentation in OpenCV Python" href="../OpenCV_ColorSegmentation/index.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.08.06 -->
        <title>Control Theory Basics - Titan Robotics 2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Titan Robotics 2024 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Titan Robotics 2024 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Preseason Training</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Preseason Training</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Overview/index.html">Programming Subteam Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LEDProgramming/index.html">LED Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../JavaBasics/index.html">Java Basics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Java Basics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../JavaBasics/InventoryManager.html">1 - Inventory Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../JavaBasics/WordleClone.html">2 - Wordle Clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../JavaBasics/BrainfInterpreter.html">3 - Brainf interpreter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../JavaBasics/OldNotes.html">Old notes from 2023</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TankDriveSimulation/index.html">Tank Drive Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TankAutonomous/index.html">Tank Autonomous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ElectricalOverview/index.html">Electrical overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinuxInstallation/index.html">Linux installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../OpenCV_ColorSegmentation/index.html">Color-based segmentation in OpenCV Python</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Control Theory Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024CodeOverview/index.html">2024 Code overview</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Resources/index.html">Resources</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Resources</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Resources/StyleGuide.html">Style guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Resources/Applications/index.html">Applications</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Applications</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Resources/Applications/git.html">Git</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Resources/RobotDesign/index.html">5 - Robot design</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Resources/JavaProgramming/index.html">Java / roboRIO Programming</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Java / roboRIO Programming</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Resources/JavaProgramming/installation.html">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Resources/CppProgramming/index.html">2 - C++ Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Resources/Coprocessors/index.html">3 - Coprocessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Resources/Linux/index.html">4 - Linux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../TitanAlgorithms/index.html">Titan Algorithms</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TitanProcessing/index.html">Titan Processing</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Titan Processing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TitanProcessing/Installation/index.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TitanProcessing/Calibration/index.html">Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TitanProcessing/AprilTags/index.html">AprilTag Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TitanProcessing/Localization/index.html">Localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TitanProcessing/Networking/index.html">Networking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../TitanDashboard/index.html">Titan Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TeamHistory/index.html">Team #2022 History</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/titan2022/docs/blob/dev/source/PreseasonTraining/ControlTheoryBasics/index.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/titan2022/docs/edit/dev/source/PreseasonTraining/ControlTheoryBasics/index.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="control-theory-basics">
<h1>Control Theory Basics<a class="headerlink" href="#control-theory-basics" title="Permalink to this heading">¶</a></h1>
<p>2024 October 22/23 (2.5 hours)</p>
<p><a class="reference internal" href="#"><span class="xref myst">Slideshow (Control theory basics)</span></a></p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Control theory is probably the most important subject in FRC programming, and one you should consider a top priority. It is what separates well-performing robots from those that fail early. Contrary to what many people assume, what a robot design should aim to optimize for first is reliability, instead of speed and function. At Titan Robotics, it is our curse to overengineer solutions that do more than we can reasonably achieve, leading to barely any time for electrical and programming to test before the first competition and cause unforeseen mechanical issues in production. In their yearly strategy presentations, team 1678 (Citrus Circuits) consistently advises other teams to stick to tested solutions even if that means missing out on strategic advantages, as they often illustrate this by discouraging teams to use swerve drive without long-term experience with it. Mechanical, electrical, and programming all share the same goal—maximizing reliability. And so, on the programming side, this is how it is done.</p>
<section id="the-problem">
<h3>The Problem<a class="headerlink" href="#the-problem" title="Permalink to this heading">¶</a></h3>
<p>The biggest obstacle in robotics, which prevents us from completely solving every mechanical and programming problem, is noise. In practice, any mechanical system will have a variable amount of bending, twisting, slack, and other often unwanted forms of temporary deformation in rigid objects. This is also a unique aspect of FRC when comparing to other high-school level robotics programs. Many material properties start to show significantly at lengths and masses of the FRC size, unlike the more compact FTC and VEX robots. Simple contraptions, like measuring tape as a robot mechanism (used by teams in the 2020 FTC competition), would not work in FRC because of reliability criteria. At such scale, you want to manuever the robot while adapting to undesirable physical changes.</p>
</section>
</section>
<section id="what-is-control-theory">
<h2>What is Control Theory<a class="headerlink" href="#what-is-control-theory" title="Permalink to this heading">¶</a></h2>
<section id="open-loop-vs-closed-loop">
<h3>Open-Loop vs. Closed-Loop<a class="headerlink" href="#open-loop-vs-closed-loop" title="Permalink to this heading">¶</a></h3>
<p>Control theory is a field of applied mathematics regarding optimizing control systems for accuracy and response time. There are two types of control: open-loop (feedforward) and closed-loop (feedback). As the names suggest, open-loop control utilizes inputs to determine an output without considering the output. Closed-loop control utilizes output back into the system, hence its second name “feedback”. An example of an open-loop system is boiling water on a gas stove for a certain time. The gas stove only cares about the volume of gas that the user selects, and does not care about whether or not the water is boiling or what the temperature of the water is. Temperature-regulating air conditioners and HVAC systems are an example of a closed-loop system: the temperature is fed back into the control system to determine the new output, eventually adjusting the room to the desired temperature.</p>
<p>There are many systems that depend on closed-loop control to function. Reliably controlling DC motors to be at certain rotational speed is not possible without taking into account its rotational output measured by an encoder. The motor controller uses this value to compute a close-enough voltage to feed into the motor.</p>
</section>
</section>
<section id="pid-controllers">
<h2>PID Controllers<a class="headerlink" href="#pid-controllers" title="Permalink to this heading">¶</a></h2>
<p>PID (proportional–integral–derivative) controllers are the most common form of adjustable closed-loop controllers. It allows you to tweak three constant coefficients (as stated by its name) to increase efficiency and response while lowering undesirable effects like undershooting or overshooting.</p>
<p>Imagine you are trying to drive a car to a location on a straight but slippery and poorly constructed road. Call your destination’s location <span class="math notranslate nohighlight">\(r(t)\)</span> (also called the <strong>setpoint</strong>). At time <span class="math notranslate nohighlight">\(t\)</span>, you know that your car is located at <span class="math notranslate nohighlight">\(y(t)\)</span>. These are the two variable inputs to the PID controller. The <strong>process variable</strong>, <span class="math notranslate nohighlight">\(e(t) = r(t) - y(t)\)</span>, is the difference between the destination and the car’s current position.</p>
<p>The constant inputs to the PID controller are <span class="math notranslate nohighlight">\(K_p\)</span>, <span class="math notranslate nohighlight">\(K_i\)</span>, and <span class="math notranslate nohighlight">\(K_d\)</span>, three coefficients that go into the equation <span class="math notranslate nohighlight">\(u(t) = K_p e(t) + K_i \int_0^t e(\tau)\,d\tau + K_d \frac{de(t)}{dt}\)</span>, where <span class="math notranslate nohighlight">\(u(t)\)</span> is the distance that we tell the car to go at time <span class="math notranslate nohighlight">\(t\)</span>. (It isn’t too important to understand this math.) We send <span class="math notranslate nohighlight">\(u(t)\)</span> to the motor, and wait until we figure out where the car is after we tried to drive <span class="math notranslate nohighlight">\(u(t)\)</span>. Then we repeat this process.</p>
<figure class="align-default" id="id1">
<img alt="../../_images/PID_en.svg" src="../../_images/PID_en.svg" /><figcaption>
<p><span class="caption-text">The basic idea of a PID controller</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<section id="the-effect-of-changing-k-p-k-i-and-k-d">
<h3>The effect of changing <span class="math notranslate nohighlight">\(K_p\)</span>, <span class="math notranslate nohighlight">\(K_i\)</span>, and <span class="math notranslate nohighlight">\(K_d\)</span><a class="headerlink" href="#the-effect-of-changing-k-p-k-i-and-k-d" title="Permalink to this heading">¶</a></h3>
<p>Say we want to drive our car to the campground 1 mile down the road. We use a PID controller to control the acceleration of the car, but we don’t know the optimal <span class="math notranslate nohighlight">\(K_p\)</span>, <span class="math notranslate nohighlight">\(K_i\)</span>, and <span class="math notranslate nohighlight">\(K_d\)</span>, so we try driving our car using the PID controller a few times.</p>
<p>This is what happens when we change <span class="math notranslate nohighlight">\(K_p\)</span>:</p>
<figure class="align-default">
<img alt="../../_images/PID_varyingP.jpg" src="../../_images/PID_varyingP.jpg" />
</figure>
<p>This is what happens when we change <span class="math notranslate nohighlight">\(K_i\)</span>:</p>
<figure class="align-default">
<img alt="../../_images/Change_with_Ki.png" src="../../_images/Change_with_Ki.png" />
</figure>
<p>This is what happens when we change <span class="math notranslate nohighlight">\(K_d\)</span>:</p>
<figure class="align-default">
<img alt="../../_images/Change_with_Kd.png" src="../../_images/Change_with_Kd.png" />
</figure>
<p>In general, we usually set <span class="math notranslate nohighlight">\(K_i = 0\)</span>, and we manually tune <span class="math notranslate nohighlight">\(K_p\)</span> and <span class="math notranslate nohighlight">\(K_d\)</span>. None of these constants should usually be significantly more than 1.0, as that tends to cause drastic overshooting.</p>
<blockquote>
<div><p>NOTE: Another less-regarded factor in PID loops is data frequency. Since it’s a discrete model, lower delta time results in better calculations.</p>
</div></blockquote>
</section>
<section id="using-the-pid-controller-on-the-robot">
<h3>Using the PID controller on the robot<a class="headerlink" href="#using-the-pid-controller-on-the-robot" title="Permalink to this heading">¶</a></h3>
<p>There is a PID controller implemented in every Falcon 500 motor. Every output on the robot—this being the swerve drivebase wheels and rotators, the arm, the elevator, etc—should ideally go through a PID controller with correctly tuned PID constants. The math behind it isn’t necessary to learn to use one, but <a class="reference external" href="https://docs.wpilib.org/en/stable/docs/software/advanced-controls/introduction/introduction-to-pid.html">this article</a> on the WPILib documentation explains it well. WPILib includes a <code class="docutils literal notranslate"><span class="pre">PIDController</span></code> <a class="reference external" href="https://docs.wpilib.org/en/stable/docs/software/advanced-controls/controllers/pidcontroller.html">class implementation</a> for general use.</p>
</section>
<section id="exercise-1-tuning-a-pid-controller">
<h3>Exercise 1 - Tuning a PID controller<a class="headerlink" href="#exercise-1-tuning-a-pid-controller" title="Permalink to this heading">¶</a></h3>
<p>See an <a class="reference external" href="https://eliottwiener.github.io/pidcontroldemo/">interactive example here</a> that shows a circle attempting to position itself under the cursor. Here is another <a class="reference external" href="https://sparshg.dev/pid-balancer/">interesting website</a> that shows a simulation of a cart balancing an arm by changing its velocity using PID. There are many strategies for tuning PID, but <a class="reference external" href="https://robotics.stackexchange.com/questions/167/what-are-good-strategies-for-tuning-pid-loops">this</a> is the one I have bookmarked and use for FRC.</p>
<p><strong>Exercise 1:</strong> Try to tune the PID constants of <a class="reference internal" href="#(https://eliottwiener.github.io/pidcontroldemo/)"><span class="xref myst">the first example</span></a> for optimal behavior.</p>
</section>
<section id="pid-with-feedforward">
<h3>PID with feedforward<a class="headerlink" href="#pid-with-feedforward" title="Permalink to this heading">¶</a></h3>
<p>Sometimes it is beneficial to add a feedforward component to a PID control system to compensate for variables in specific circumstances. We utilized PIDf in our old swerve subsystem code to account for friction. In practice, the implementation is incredibly simple. Add the desired amount of feedforward output multiplied by a coefficient to the PID output. <a class="reference external" href="https://docs.wpilib.org/en/stable/docs/software/advanced-controls/controllers/combining-feedforward-feedback.html">This WPILib article</a> shows PIDf in practice.</p>
</section>
<section id="further-reading-on-pid">
<h3>Further reading on PID<a class="headerlink" href="#further-reading-on-pid" title="Permalink to this heading">¶</a></h3>
<p>If you want more to read, or are a bit confused, see:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Proportional%E2%80%93integral%E2%80%93derivative_controller">Wikipedia article on PID controllers</a></p></li>
<li><p><a class="reference external" href="https://docs.wpilib.org/en/stable/docs/software/advanced-controls/introduction/introduction-to-pid.html">WPILib docs article on PID controllers</a></p></li>
<li><p>Chapters 1 and 2 of <a class="reference external" href="https://file.tavsys.net/control/controls-engineering-in-frc.pdf"><em>Controls Engineering in FRC</em></a></p></li>
</ul>
</section>
</section>
<section id="more-on-robot-control">
<h2>More On Robot Control<a class="headerlink" href="#more-on-robot-control" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>CW: long yapathon ahead</p>
</div></blockquote>
<section id="the-problem-in-practice">
<h3>The Problem: In Practice<a class="headerlink" href="#the-problem-in-practice" title="Permalink to this heading">¶</a></h3>
<p>A common example of affected software input is when you introduce an encoder to measure axis position. There are several factors that will impact your readings: wheel and belt slippage, friction, gearbox slack, misalignment of the sensor itself, and many other factors. Then when you want to output a signal to a motor, such as one controlling an arm, you have to deal with more factors: gravity, variable friction of the system, variable arm weight that affects torque, and many more. These physical factors often cannot be calculated because of their complexity and noise. Since it is impossible to make the perfect encoder measuring system, the best you can do is minimize those factors during the design process and account for them in software. If a system contains more than one rotating axis, the encoder should be placed on the axis closest to the output to minimize effect of gear slack. Belts can prevent this as they don’t require the same tolerances, but ideally the encoder should be placed in the most representative place of what you are trying to measure.</p>
</section>
<section id="what-typically-happens">
<h3>What Typically Happens<a class="headerlink" href="#what-typically-happens" title="Permalink to this heading">¶</a></h3>
<p>On the software side, the raw encoder output can (and often is already by your library) be filtered through various methods to separate the desired signal from the noise. We will cover some of these methods later. But ultimately, it is also important to direct robot output in such a way that accounts for physical aspects without the need to model unpredictable complexity. When you create a plan on how to program a rotating arm, the first instinct of us is to recreate a geometric model of the arm from the motor output. We are used to drawing diagrams and solving problems through simulations in physics and math classes at IMSA and previously. But the real world is too complex for inverse kinematics based on torque equations to be accurate enough. Some of these equations weren’t even defined for ranges of values appearing in production. Although theoretical models are still very applicable in FRC, many systems used in FRC are hard to describe using these theoretical models, or have so much potential for error that the theoretical model won’t accurately predict how the system will be have in the real world. Combining those models with control theory methods for reducing the impact of noise (such as adding a PID controller as the last step) leads to great results.</p>
</section>
<section id="design-decisions-first">
<h3>Design Decisions First<a class="headerlink" href="#design-decisions-first" title="Permalink to this heading">¶</a></h3>
<p>More often than not, the simplest solutions are also the best, most reliable. Going back to the arm programming example, it is important to consider all constraints and criteria of the problem. Removing unnecessary functionality is one way to approach it. Does your arm need to move to any position in its degree of freedom? Does it need to do so with speed, precision, accuracy, while holding a heavy object, without causing too much acceleration? Perhaps you may only need to move it to three total positions throughout the entire game? If so, maybe an elevator system would actually be a more suitable mechanism as it only has one degree of freedom with higher rigidity. Programming an elevator, which consists of a pulleys with a motor or two, is significantly easier than programming a rotating arm affected by gravity. It is more energy efficient too as it won’t require as much current draw to counter gravity with motors (another factor that needs higher consideration: less subsystem power usage means a faster drivebase). In this case, your first action should be to run to the nearest design member and ruin their dreams of attaching a custom 5-axis arm to the swerve drivebase.</p>
</section>
<section id="implications-of-complexity">
<h3>Implications of Complexity<a class="headerlink" href="#implications-of-complexity" title="Permalink to this heading">¶</a></h3>
<p>Although, sometimes you might have to be stuck with programming a rotating arm. In which case, you can predetermine the necessary motor values beforehand. Create a table for the arm to be static at a certain angle and also that angle but with a weighted object. It seems simple in theory, but once you realize that the battery voltage affects motor output, the problem gets exponentially more difficult. Now imagine if you still decided to stick with your old inverse kinematics equation. Your equation would now have to consider battery strain, on top of drivebase movement and other factors. And now, consider this but with the typical occurrence: you only have two hours a week to test it and competition is coming up. What about other subsystems? You have code for them too and you need to test it (your drivebase code should be consistent over the years for this reason). Well, what if the member who singlehandedly wrote the arm subsystem and every command for it gets sick? It is far simpler to debug a close-enough estimation of the real world than complex equations that model it.</p>
<p>But this section is an exaggeration: most FRC teams do not encounter every possible negative outcome in one season. Simply, it is to state that robot design and programming should account for unforeseen challenges. The pandemic has taken a toll on this team as significant amount of knowledge and connections have been lost. But with each season, there are improvements. The arm example is a retelling of the events that occurred during the 2022-2023 FRC season when our knowledge regarding creating reliable designs and writing reliable code was limited. I encourage reading ChiefDelphi posts for the purpose of regaining these skills. What separates consistently well-performing teams and everyone else is proper documentation and long-term connections.</p>
</section>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">¶</a></h2>
<p>I strongly recommend reading at least some chapters of this <a class="reference external" href="https://file.tavsys.net/control/controls-engineering-in-frc.pdf">FRC-specific book on control theory</a> for more information. This manual contains the essential knowledge of classical control theory, specific examples of modeling many mechanisms present in FRC, inverse kinematics, calculus and linear algebra prerequisites needed to learn about Kalman Filters (BC sequence + MVC + LinAlg level math), different types of Kalman Filters, and much more. Reading the book in its entirety would set your control theory and mathematical knowledge above majority of FRC programmers, even on top performing teams.</p>
<p><a class="reference external" href="https://github.com/rlabbe/Kalman-and-Bayesian-Filters-in-Python">This particular repository about Kalman Filters</a> is another great source to learn about Kalman Filters. This repo provided the knowledge to implement the Extended Kalman Filter used in <a class="reference external" href="https://github.com/titan2022/Titan-Processing">Titan Processing</a>.</p>
<section id="image-credits">
<h3>Image credits<a class="headerlink" href="#image-credits" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>https://commons.wikimedia.org/wiki/File:PID_en.svg by Arturo Urquizo</p></li>
<li><p>https://commons.wikimedia.org/wiki/File:PID_varyingP.jpg by User:TimmmyK</p></li>
<li><p>https://commons.wikimedia.org/wiki/File:Change_with_Ki.png by User:Skorkmaz</p></li>
<li><p>https://commons.wikimedia.org/wiki/File:Change_with_Kd.png by User:Skorkmaz</p></li>
</ul>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../2024CodeOverview/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">2024 Code overview</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../OpenCV_ColorSegmentation/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Color-based segmentation in OpenCV Python</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Titan Robotics #2022
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Control Theory Basics</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#the-problem">The Problem</a></li>
</ul>
</li>
<li><a class="reference internal" href="#what-is-control-theory">What is Control Theory</a><ul>
<li><a class="reference internal" href="#open-loop-vs-closed-loop">Open-Loop vs. Closed-Loop</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pid-controllers">PID Controllers</a><ul>
<li><a class="reference internal" href="#the-effect-of-changing-k-p-k-i-and-k-d">The effect of changing <span class="math notranslate nohighlight">\(K_p\)</span>, <span class="math notranslate nohighlight">\(K_i\)</span>, and <span class="math notranslate nohighlight">\(K_d\)</span></a></li>
<li><a class="reference internal" href="#using-the-pid-controller-on-the-robot">Using the PID controller on the robot</a></li>
<li><a class="reference internal" href="#exercise-1-tuning-a-pid-controller">Exercise 1 - Tuning a PID controller</a></li>
<li><a class="reference internal" href="#pid-with-feedforward">PID with feedforward</a></li>
<li><a class="reference internal" href="#further-reading-on-pid">Further reading on PID</a></li>
</ul>
</li>
<li><a class="reference internal" href="#more-on-robot-control">More On Robot Control</a><ul>
<li><a class="reference internal" href="#the-problem-in-practice">The Problem: In Practice</a></li>
<li><a class="reference internal" href="#what-typically-happens">What Typically Happens</a></li>
<li><a class="reference internal" href="#design-decisions-first">Design Decisions First</a></li>
<li><a class="reference internal" href="#implications-of-complexity">Implications of Complexity</a></li>
</ul>
</li>
<li><a class="reference internal" href="#further-reading">Further Reading</a><ul>
<li><a class="reference internal" href="#image-credits">Image credits</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=172f29ee"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>